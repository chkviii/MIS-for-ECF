var nobleEd25519=(()=>{var O=Object.defineProperty;var mt=Object.getOwnPropertyDescriptor;var At=Object.getOwnPropertyNames;var gt=Object.prototype.hasOwnProperty;var Bt=(t,n)=>{for(var s in n)O(t,s,{get:n[s],enumerable:!0})},wt=(t,n,s,e)=>{if(n&&typeof n=="object"||typeof n=="function")for(let c of At(n))!gt.call(t,c)&&c!==s&&O(t,c,{get:()=>n[c],enumerable:!(e=mt(n,c))||e.enumerable});return t};var Zt=t=>wt(O({},"__esModule",{value:!0}),t);var Gt={};Bt(Gt,{getPublicKeyAsync:()=>N,keygenAsync:()=>dt,signAsync:()=>at,verifyAsync:()=>ut});var Q={p:0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffedn,n:0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3edn,h:8n,a:0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffecn,d:0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3n,Gx:0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51an,Gy:0x6666666666666666666666666666666666666666666666666666666666666658n},{p,n:R,Gx:$,Gy:j,a:P,d:F,h:Tt}=Q,B=32,_=64,Xt=(...t)=>{"captureStackTrace"in Error&&typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(...t)},h=(t="")=>{let n=new Error(t);throw Xt(n,h),n},Et=t=>typeof t=="bigint",Yt=t=>typeof t=="string",_t=t=>t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array",A=(t,n,s="")=>{let e=_t(t),c=t?.length,r=n!==void 0;if(!e||r&&c!==n){let f=s&&`"${s}" `,a=r?` of length ${n}`:"",i=e?`length=${c}`:`type=${typeof t}`;h(f+"expected Uint8Array"+a+", got "+i)}return t},L=t=>new Uint8Array(t),tt=t=>Uint8Array.from(t),nt=(t,n)=>t.toString(16).padStart(n,"0"),st=t=>Array.from(A(t)).map(n=>nt(n,2)).join(""),g={_0:48,_9:57,A:65,F:70,a:97,f:102},D=t=>{if(t>=g._0&&t<=g._9)return t-g._0;if(t>=g.A&&t<=g.F)return t-(g.A-10);if(t>=g.a&&t<=g.f)return t-(g.a-10)},et=t=>{let n="hex invalid";if(!Yt(t))return h(n);let s=t.length,e=s/2;if(s%2)return h(n);let c=L(e);for(let r=0,f=0;r<e;r++,f+=2){let a=D(t.charCodeAt(f)),i=D(t.charCodeAt(f+1));if(a===void 0||i===void 0)return h(n);c[r]=a*16+i}return c},ot=()=>globalThis?.crypto,St=()=>ot()?.subtle??h("crypto.subtle must be defined, consider polyfill"),S=(...t)=>{let n=L(t.reduce((e,c)=>e+A(c).length,0)),s=0;return t.forEach(e=>{n.set(e,s),s+=e.length}),n},vt=(t=B)=>ot().getRandomValues(L(t)),K=BigInt,T=(t,n,s,e="bad number: out of range")=>Et(t)&&n<=t&&t<s?t:h(e),o=(t,n=p)=>{let s=t%n;return s>=0n?s:n+s},ct=t=>o(t,R),Rt=(t,n)=>{(t===0n||n<=0n)&&h("no inverse n="+t+" mod="+n);let s=o(t,n),e=n,c=0n,r=1n,f=1n,a=0n;for(;s!==0n;){let i=e/s,l=e%s,u=c-f*i,d=r-a*i;e=s,s=l,c=f,r=a,f=u,a=d}return e===1n?o(c,n):h("no inverse")};var U=t=>t instanceof w?t:h("Point expected"),V=2n**256n,w=class t{static BASE;static ZERO;X;Y;Z;T;constructor(n,s,e,c){let r=V;this.X=T(n,0n,r),this.Y=T(s,0n,r),this.Z=T(e,1n,r),this.T=T(c,0n,r),Object.freeze(this)}static CURVE(){return Q}static fromAffine(n){return new t(n.x,n.y,1n,o(n.x*n.y))}static fromBytes(n,s=!1){let e=F,c=tt(A(n,B)),r=n[31];c[31]=r&-129;let f=G(c);T(f,0n,s?V:p);let i=o(f*f),l=o(i-1n),u=o(e*i+1n),{isValid:d,value:y}=kt(l,u);d||h("bad point: y not sqrt");let b=(y&1n)===1n,x=(r&128)!==0;return!s&&y===0n&&x&&h("bad point: x==0, isLastByteOdd"),x!==b&&(y=o(-y)),new t(y,f,1n,o(y*f))}static fromHex(n,s){return t.fromBytes(et(n),s)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}assertValidity(){let n=P,s=F,e=this;if(e.is0())return h("bad point: ZERO");let{X:c,Y:r,Z:f,T:a}=e,i=o(c*c),l=o(r*r),u=o(f*f),d=o(u*u),y=o(i*n),b=o(u*o(y+l)),x=o(d+o(s*o(i*l)));if(b!==x)return h("bad point: equation left != right (1)");let X=o(c*r),E=o(f*a);return X!==E?h("bad point: equation left != right (2)"):this}equals(n){let{X:s,Y:e,Z:c}=this,{X:r,Y:f,Z:a}=U(n),i=o(s*a),l=o(r*c),u=o(e*a),d=o(f*c);return i===l&&u===d}is0(){return this.equals(Y)}negate(){return new t(o(-this.X),this.Y,this.Z,o(-this.T))}double(){let{X:n,Y:s,Z:e}=this,c=P,r=o(n*n),f=o(s*s),a=o(2n*o(e*e)),i=o(c*r),l=n+s,u=o(o(l*l)-r-f),d=i+f,y=d-a,b=i-f,x=o(u*y),X=o(d*b),E=o(u*b),v=o(y*d);return new t(x,X,v,E)}add(n){let{X:s,Y:e,Z:c,T:r}=this,{X:f,Y:a,Z:i,T:l}=U(n),u=P,d=F,y=o(s*f),b=o(e*a),x=o(r*d*l),X=o(c*i),E=o((s+e)*(f+a)-y-b),v=o(X-x),z=o(X+x),M=o(b-u*y),ht=o(E*v),pt=o(z*M),bt=o(E*M),xt=o(v*z);return new t(ht,pt,xt,bt)}subtract(n){return this.add(U(n).negate())}multiply(n,s=!0){if(!s&&(n===0n||this.is0()))return Y;if(T(n,1n,R),n===1n)return this;if(this.equals(Z))return qt(n).p;let e=Y,c=Z;for(let r=this;n>0n;r=r.double(),n>>=1n)n&1n?e=e.add(r):s&&(c=c.add(r));return e}multiplyUnsafe(n){return this.multiply(n,!1)}toAffine(){let{X:n,Y:s,Z:e}=this;if(this.equals(Y))return{x:0n,y:1n};let c=Rt(e,p);o(e*c)!==1n&&h("invalid inverse");let r=o(n*c),f=o(s*c);return{x:r,y:f}}toBytes(){let{x:n,y:s}=this.assertValidity().toAffine(),e=rt(s);return e[31]|=n&1n?128:0,e}toHex(){return st(this.toBytes())}clearCofactor(){return this.multiply(K(Tt),!1)}isSmallOrder(){return this.clearCofactor().is0()}isTorsionFree(){let n=this.multiply(R/2n,!1).double();return R%2n&&(n=n.add(this)),n.is0()}},Z=new w($,j,1n,o($*j)),Y=new w(0n,1n,1n,0n);w.BASE=Z;w.ZERO=Y;var rt=t=>et(nt(T(t,0n,V),_)).reverse(),G=t=>K("0x"+st(tt(A(t)).reverse())),m=(t,n)=>{let s=t;for(;n-- >0n;)s*=s,s%=p;return s},Kt=t=>{let s=t*t%p*t%p,e=m(s,2n)*s%p,c=m(e,1n)*t%p,r=m(c,5n)*c%p,f=m(r,10n)*r%p,a=m(f,20n)*f%p,i=m(a,40n)*a%p,l=m(i,80n)*i%p,u=m(l,80n)*i%p,d=m(u,10n)*r%p;return{pow_p_5_8:m(d,2n)*t%p,b2:s}},I=0x2b8324804fc1df0b2b4d00993dfbd7a72f431806ad2fe478c4ee1b274a0ea0b0n,kt=(t,n)=>{let s=o(n*n*n),e=o(s*s*n),c=Kt(t*e).pow_p_5_8,r=o(t*s*c),f=o(n*r*r),a=r,i=o(r*I),l=f===t,u=f===o(-t),d=f===o(-t*I);return l&&(r=a),(u||d)&&(r=i),(o(r)&1n)===1n&&(r=o(-r)),{isValid:l||u,value:r}},k=t=>ct(G(t)),H=(...t)=>Pt.sha512Async(S(...t));var Ct=t=>{let n=t.slice(0,B);n[0]&=248,n[31]&=127,n[31]|=64;let s=t.slice(B,_),e=k(n),c=Z.multiply(e),r=c.toBytes();return{head:n,prefix:s,scalar:e,point:c,pointBytes:r}},ft=t=>H(A(t,B)).then(Ct);var N=t=>ft(t).then(n=>n.pointBytes);var it=t=>H(t.hashable).then(t.finish);var Lt=(t,n,s)=>{let{pointBytes:e,scalar:c}=t,r=k(n),f=Z.multiply(r).toBytes();return{hashable:S(f,e,s),finish:l=>{let u=ct(r+k(l)*c);return A(S(f,rt(u)),_)}}},at=async(t,n)=>{let s=A(t),e=await ft(n),c=await H(e.prefix,s);return it(Lt(e,c,s))};var lt={zip215:!0},Ot=(t,n,s,e=lt)=>{t=A(t,_),n=A(n),s=A(s,B);let{zip215:c}=e,r,f,a,i,l=Uint8Array.of();try{r=w.fromBytes(s,c),f=w.fromBytes(t.slice(0,B),c),a=G(t.slice(B,_)),i=Z.multiply(a,!1),l=S(f.toBytes(),r.toBytes(),n)}catch{}return{hashable:l,finish:d=>{if(i==null||!c&&r.isSmallOrder())return!1;let y=k(d);return f.add(r.multiply(y,!1)).add(i.negate()).clearCofactor().is0()}}},ut=async(t,n,s,e=lt)=>it(Ot(t,n,s,e));var Pt={sha512Async:async t=>{let n=St(),s=S(t);return L(await n.digest("SHA-512",s.buffer))},sha512:void 0},Ft=(t=vt(B))=>t;var dt=async t=>{let n=Ft(t),s=await N(n);return{secretKey:n,publicKey:s}};var C=8,Ut=256,yt=Math.ceil(Ut/C)+1,q=2**(C-1),Vt=()=>{let t=[],n=Z,s=n;for(let e=0;e<yt;e++){s=n,t.push(s);for(let c=1;c<q;c++)s=s.add(n),t.push(s);n=s.double()}return t},W,J=(t,n)=>{let s=n.negate();return t?s:n},qt=t=>{let n=W||(W=Vt()),s=Y,e=Z,c=2**C,r=c,f=K(c-1),a=K(C);for(let i=0;i<yt;i++){let l=Number(t&f);t>>=a,l>q&&(l-=r,t+=1n);let u=i*q,d=u,y=u+Math.abs(l)-1,b=i%2!==0,x=l<0;l===0?e=e.add(J(b,n[d])):s=s.add(J(x,n[y]))}return t!==0n&&h("invalid wnaf"),{p:s,f:e}};return Zt(Gt);})();
/*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) */
